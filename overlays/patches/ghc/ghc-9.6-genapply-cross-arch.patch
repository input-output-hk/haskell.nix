diff --git a/utils/genapply/Main.hs b/utils/genapply/Main.hs
index 74351ee..8a6513c 100644
--- a/utils/genapply/Main.hs
+++ b/utils/genapply/Main.hs
@@ -12,6 +12,17 @@
 -- for details
 module Main(main) where
 
+-- GHC will helpfully pass
+-- -Dlinux_BUILD_OS -Dx86_64_BUILD_ARCH -Dlinux_HOST_OS -Dx86_64_HOST_ARCH -D__GLASGOW_HASKELL_TH__ -D__SSE__ -D__SSE2__ '-D__IO_MANAGER_MIO__=1'
+-- to cc -E when running the CPP phase. :-/ So we have to undefine them.
+#if defined(linux_BUILD_OS) || defined(x86_64_BUILD_ARCH) || defined(linux_HOST_OS) || defined(x86_64_HOST_ARCH)
+#warning "Undefining macros that GHC passes to CPP"
+#undef linux_BUILD_OS
+#undef x86_64_BUILD_ARCH
+#undef linux_HOST_OS
+#undef x86_64_HOST_ARCH
+#endif
+
 -- Note [Genapply target as host for RTS macros]
 -- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 -- We improperly include *HOST* macros for our target...
@@ -957,6 +968,12 @@ main = do
                 text "// DO NOT EDIT!",
                 text "// Automatically generated by utils/genapply/Main.hs",
                 text "",
+                text "// DEBUG: SIZEOF_VOID_P " <> int SIZEOF_VOID_P,
+                text "// DEBUG: HOST_ARCH " <> text HOST_ARCH,
+                text "// DEBUG: HOST_OS " <> text HOST_OS,
+                text "// DEBUG: BUILD_ARCH " <> text BUILD_ARCH,
+                text "// DEBUG: BUILD_OS " <> text BUILD_OS,
+                text "",
                 text "#include \"Cmm.h\"",
                 text "#include \"AutoApply.h\"",
                 text "#if !defined(UnregisterisedCompiler)",
